#!/bin/sh

uname=
for i in /bin/uname.bak /tools/bin/uname.bak; do
	if [ -x "$i" ]; then
		uname=${i}
		break
	fi
done

if [ -z "${uname}" ]; then
	exit 127
fi

machine=$(${uname} -m)
kernel=$(${uname} -r)
output=$(${uname} $@)

# Overwrite kernel version to hack kernel 3.x versions.
output=$(sed -e "s/${kernel}/${KVER}/g" <<<${output})

case "${machine}" in
	armv*)
		echo "${output}" | \
			sed -e "s/armv.*l/${MACHINE}/g"
		;;

	i?86)
		echo "${output}" | \
			sed -e "s/i.86/${MACHINE}/g"
		;;
esac
