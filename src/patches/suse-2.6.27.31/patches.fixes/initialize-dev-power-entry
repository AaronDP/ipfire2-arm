From: Jeff Mahoney <jeffm@suse.com>
Subject: pm: initialize &dev->power.entry
References: bnc#514022

 dev->power.entry is uninitialized, which can lead to Oopses if the device
 is removed early.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/base/power/power.h |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/base/power/power.h
+++ b/drivers/base/power/power.h
@@ -1,6 +1,9 @@
 static inline void device_pm_init(struct device *dev)
 {
 	dev->power.status = DPM_ON;
+#ifdef CONFIG_PM_SLEEP
+	INIT_LIST_HEAD(&dev->power.entry);
+#endif
 }
 
 #ifdef CONFIG_PM_SLEEP
