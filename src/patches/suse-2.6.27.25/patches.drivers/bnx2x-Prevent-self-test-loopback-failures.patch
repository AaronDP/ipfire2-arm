From 3858276b7198074bf3570470463808627f0c9e31 Mon Sep 17 00:00:00 2001
From: Eilon Greenstein <eilong@broadcom.com>
Date: Wed, 14 Jan 2009 06:44:16 +0000
Subject: bnx2x: Prevent self test loopback failures
Acked-by: Karsten Keil <kkeil@novell.com>
Reference: bnc#472500

Setting loopback requires time to take effect

Signed-off-by: Yaniv Rosner <yanivr@broadcom.com>
Signed-off-by: Eilon Greenstein <eilong@broadcom.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
---
 drivers/net/bnx2x_link.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

Index: linux-2.6.27-bnx2x_2/drivers/net/bnx2x_link.c
===================================================================
--- linux-2.6.27-bnx2x_2.orig/drivers/net/bnx2x_link.c
+++ linux-2.6.27-bnx2x_2/drivers/net/bnx2x_link.c
@@ -3583,7 +3583,7 @@ static void bnx2x_set_xgxs_loopback(stru
 			       (MDIO_REG_BANK_CL73_IEEEB0 +
 				(MDIO_CL73_IEEEB0_CL73_AN_CONTROL & 0xf)),
 			       0x6041);
-
+		msleep(200);
 		/* set aer mmd back */
 		bnx2x_set_aer_mmd(params, vars);
 
